# Loose Coupling μ•„ν‚¤ν…μ² μ„¤κ³„

## π“‹ κ°μ”

Kirakira ν”„λ΅μ νΈλ” **μ™„μ „ν• Loose Coupling** κµ¬μ΅°λ¥Ό μ κ³µν•μ—¬, Three.js ν¨κ³Ό κ°λ°μκ°€ λ©”μΈ ν”„λ΅μ νΈμ™€ λ…λ¦½μ μΌλ΅ ν¨κ³Όλ¥Ό κ°λ°ν•  μ μμµλ‹λ‹¤.

---

## β… Loose Coupling κµ¬ν„ ν„ν™©

### 1. **μΈν„°νμ΄μ¤ κΈ°λ° μ„¤κ³„** β­β­β­β­β­

ν¨κ³Ό λ¨λ“μ€ ν‘μ¤€ μΈν„°νμ΄μ¤λ§ κµ¬ν„ν•λ©΄ λ©λ‹λ‹¤:

```typescript
// ν¨κ³Ό κ°λ°μλ” μ΄ μΈν„°νμ΄μ¤λ§ μ•λ©΄ λ¨
interface EffectModule {
  init: (scene: THREE.Scene, params: Record<string, any>) => EffectObjects;
  update: (objects: EffectObjects, params: Record<string, any>, deltaTime: number) => void;
  dispose: (scene: THREE.Scene, objects: EffectObjects) => void;
}
```

**ν‰κ°€**: β… **μ™„λ²½ν• Loose Coupling**
- λ©”μΈ ν”„λ΅μ νΈμ λ‚΄λ¶€ κµ¬ν„μ„ μ• ν•„μ” μ—†μ
- μΈν„°νμ΄μ¤λ§ κµ¬ν„ν•λ©΄ μλ™μΌλ΅ ν†µν•©λ¨

### 2. **λ™μ  λ΅λ”©** β­β­β­β­

```typescript
// λ°νƒ€μ„μ— λ™μ μΌλ΅ λ΅λ“
const { module } = await EffectLoader.loadEffect('gnParticles', '/my-effects');
```

**ν‰κ°€**: β… **Loose Coupling**
- μ»΄νμΌ νƒ€μ„ μμ΅΄μ„± μ—†μ
- λ°νƒ€μ„μ— λ™μ μΌλ΅ μ—°κ²°

### 3. **λ…λ¦½μ μΈ λ””λ ‰ν† λ¦¬** β­β­β­β­β­

```
my-effects/              # μ™„μ „ν λ…λ¦½μ μΈ λ””λ ‰ν† λ¦¬
β”β”€β”€ gnParticles/
β”‚   β”β”€β”€ index.ts         # ν¨κ³Ό κµ¬ν„
β”‚   β”β”€β”€ package.json     # λ…λ¦½μ μΈ μμ΅΄μ„±
β”‚   β””β”€β”€ tsconfig.json     # λ…λ¦½μ μΈ μ„¤μ •
β””β”€β”€ manifest.json         # ν¨κ³Ό λ©λ΅
```

**ν‰κ°€**: β… **μ™„λ²½ν• Loose Coupling**
- λ©”μΈ ν”„λ΅μ νΈμ™€ μ™„μ „ν λ¶„λ¦¬
- λ³„λ„ μ €μ¥μ†λ΅ κ΄€λ¦¬ κ°€λ¥
- npm ν¨ν‚¤μ§€λ΅ λ°°ν¬ κ°€λ¥

---

## β οΈ ν„μ¬ κµ¬μ΅°μ ν•κ³„μ 

### 1. **νƒ€μ… μ •μ μμ΅΄μ„±**

**ν„μ¬ λ¬Έμ **:
```typescript
// ν¨κ³Ό κ°λ°μκ°€ λ©”μΈ ν”„λ΅μ νΈμ νƒ€μ…μ„ importν•΄μ•Ό ν•¨
import type { EffectModule, EffectObjects } from '@effects/types';
```

**κ°μ„  λ°©μ•**: νƒ€μ… μ •μλ¥Ό λ³„λ„ ν¨ν‚¤μ§€λ΅ λ¶„λ¦¬ν•κ±°λ‚, ν¨κ³Ό κ°λ°μκ°€ μ§μ ‘ νƒ€μ…μ„ μ •μν•  μ μλ„λ΅

### 2. **Vite λ™μ  Import μ ν•**

**ν„μ¬ λ¬Έμ **: Viteμ λ™μ  importλ” λΉλ“ νƒ€μ„μ— λ¶„μ„λλ―€λ΅, μ™„μ „ν μ™Έλ¶€ λ””λ ‰ν† λ¦¬μ λ¨λ“μ„ λ΅λ“ν•κΈ° μ–΄λ ¤μΈ μ μμ

**κ°μ„  λ°©μ•**: 
- κ°λ° ν™κ²½: Viteμ `fs.allow` μ„¤μ •μΌλ΅ μ™Έλ¶€ λ””λ ‰ν† λ¦¬ μ ‘κ·Ό
- ν”„λ΅λ•μ…: λΉλ“λ ν¨κ³Όλ¥Ό μ •μ  νμΌλ΅ μ„λΉ™

---

## π― μ™„μ „ν• Loose Couplingμ„ μ„ν• κ°μ„ 

### κ°μ„  1: νƒ€μ… μ •μ λ…λ¦½ν™”

ν¨κ³Ό κ°λ°μκ°€ νƒ€μ…μ„ μ§μ ‘ μ •μν•  μ μλ„λ΅:

```typescript
// my-effects/gnParticles/index.ts
// νƒ€μ…μ„ μ§μ ‘ μ •μ (λ©”μΈ ν”„λ΅μ νΈ μμ΅΄μ„± μ—†μ)
interface MyEffectObjects {
  particleSystem: THREE.Points;
  geometry: THREE.BufferGeometry;
  material: THREE.Material;
}

const myEffect = {
  init(scene: THREE.Scene, params: Record<string, any>): MyEffectObjects {
    // κµ¬ν„
  },
  // ...
};
```

### κ°μ„  2: μΈν„°νμ΄μ¤ κ²€μ¦ λ°νƒ€μ„ν™”

μ»΄νμΌ νƒ€μ„μ΄ μ•„λ‹ λ°νƒ€μ„μ— μΈν„°νμ΄μ¤λ¥Ό κ²€μ¦:

```typescript
// EffectLoaderκ°€ λ°νƒ€μ„μ— μΈν„°νμ΄μ¤ κ²€μ¦
if (typeof module.init !== 'function') {
  throw new Error('Invalid module: init method required');
}
```

### κ°μ„  3: Manifest κΈ°λ° μλ™ λ“±λ΅

ν¨κ³Ό κ°λ°μκ°€ manifestλ§ μ‘μ„±ν•λ©΄ μλ™μΌλ΅ λ“±λ΅:

```json
// my-effects/manifest.json
{
  "effects": [
    {
      "id": "gnParticles",
      "path": "./gnParticles/index.ts",
      "metadata": { ... }
    }
  ]
}
```

---

## π“ Loose Coupling ν‰κ°€

| ν•­λ© | ν„μ¬ μƒνƒ | λ©ν‘ | ν‰κ°€ |
|------|----------|------|------|
| **μΈν„°νμ΄μ¤ λ¶„λ¦¬** | β… μ™„λ²½ | β… μ™„λ²½ | β­β­β­β­β­ |
| **μμ΅΄μ„± λ¶„λ¦¬** | β οΈ νƒ€μ… μμ΅΄ | β… μ™„μ „ λ¶„λ¦¬ | β­β­β­ |
| **λ””λ ‰ν† λ¦¬ λ¶„λ¦¬** | β… μ™„λ²½ | β… μ™„λ²½ | β­β­β­β­β­ |
| **λ°νƒ€μ„ λ΅λ”©** | β… κµ¬ν„λ¨ | β… κµ¬ν„λ¨ | β­β­β­β­ |
| **λ…λ¦½μ  κ°λ°** | β οΈ λ¶€λ¶„μ  | β… μ™„μ „ | β­β­β­ |

**μ „μ²΄ ν‰κ°€**: **4.0/5.0** β­β­β­β­

---

## π”§ μ¦‰μ‹ κ°μ„  μ‚¬ν•­

### 1. νƒ€μ… μ •μλ¥Ό μ„ νƒμ μΌλ΅ λ§λ“¤κΈ°

ν¨κ³Ό κ°λ°μκ°€ νƒ€μ…μ„ importν•μ§€ μ•μ•„λ„ λλ„λ΅:

```typescript
// EffectLoaderκ°€ νƒ€μ…μ„ μλ™μΌλ΅ μ¶”λ΅ 
// ν¨κ³Ό κ°λ°μλ” λ‹¨μν κ°μ²΄λ§ exportν•λ©΄ λ¨
export default {
  init: (scene, params) => { /* ... */ },
  update: (objects, params, deltaTime) => { /* ... */ },
  dispose: (scene, objects) => { /* ... */ },
};
```

### 2. νƒ€μ… μ •μ ν¨ν‚¤μ§€ λ¶„λ¦¬

```bash
# λ³„λ„ npm ν¨ν‚¤μ§€λ΅ λ¶„λ¦¬
npm install @kirakira/effect-types
```

### 3. ν¨κ³Ό κ°λ° κ°€μ΄λ“ κ°μ„ 

ν¨κ³Ό κ°λ°μκ°€ λ©”μΈ ν”„λ΅μ νΈλ¥Ό λ°λΌλ„ κ°λ°ν•  μ μλ„λ΅ λ¬Έμ„ν™”

---

## β… κ²°λ΅ 

**ν„μ¬ κµ¬μ΅°λ” μ΄λ―Έ μƒλ‹Ήν Loose Couplingλμ–΄ μμµλ‹λ‹¤:**

β… **μ κµ¬ν„λ λ¶€λ¶„**:
- μΈν„°νμ΄μ¤ κΈ°λ° μ„¤κ³„
- λ™μ  λ΅λ”©
- λ…λ¦½μ μΈ λ””λ ‰ν† λ¦¬ κµ¬μ΅°
- λ°νƒ€μ„ κ²€μ¦

β οΈ **κ°μ„  ν•„μ”**:
- νƒ€μ… μ •μ μμ΅΄μ„± μ κ±°
- μ™„μ „ν• λ…λ¦½μ  κ°λ° ν™κ²½

**30λ…„μ°¨ μ—”μ§€λ‹μ–΄ κ΄€μ **: ν„μ¬ κµ¬μ΅°λ” **Plugin Architecture** ν¨ν„΄μ„ μ λ”°λ¥΄κ³  μμΌλ©°, λ€λ¶€λ¶„μ μ”κµ¬μ‚¬ν•­μ„ μ¶©μ΅±ν•©λ‹λ‹¤. νƒ€μ… μμ΅΄μ„±λ§ ν•΄κ²°ν•λ©΄ μ™„λ²½ν• Loose Couplingμ΄ λ©λ‹λ‹¤.

